<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>implementations.controller_classes.controller_ParaDiag_nonMPI module &#8212; pySDC 5.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=2bf1fcf8" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c40552b6" />
    
    <script src="../_static/documentation_options.js?v=81710850"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="implementations.controller_classes.controller_nonMPI module" href="implementations.controller_classes.controller_nonMPI.html" />
    <link rel="prev" title="implementations.controller_classes.controller_MPI module" href="implementations.controller_classes.controller_MPI.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.controller_classes.controller_nonMPI.html" title="implementations.controller_classes.controller_nonMPI module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="implementations.controller_classes.controller_MPI.html" title="implementations.controller_classes.controller_MPI module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.controller_classes.html" accesskey="U">implementations.controller_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.controller_classes.controller_ParaDiag_nonMPI module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-implementations.controller_classes.controller_ParaDiag_nonMPI">
<span id="implementations-controller-classes-controller-paradiag-nonmpi-module"></span><h1>implementations.controller_classes.controller_ParaDiag_nonMPI module<a class="headerlink" href="#module-implementations.controller_classes.controller_ParaDiag_nonMPI" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">controller_ParaDiag_nonMPI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_procs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">controller_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ParaDiagController</span></code></p>
<p>ParaDiag controller, running serialized version.</p>
<p>This controller uses the increment formulation. That is to say, we setup the residual of the all at once problem,
put it on the right hand side, invert the ParaDiag preconditioner on the left-hand side to compute the increment
and then add the increment onto the solution. For this reason, we need to replace the solution values in the steps
with the residual values before the solves and then put the solution plus increment back into the steps. This is a
bit counter to what you expect when you access the <cite>u</cite> variable in the levels, but it is mathematically advantageous.</p>
<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.ParaDiag">
<span class="sig-name descname"><span class="pre">ParaDiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_MS_active</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.ParaDiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.ParaDiag" title="Link to this definition">¶</a></dt>
<dd><p>Main function for ParaDiag</p>
<p>For the workflow of this controller, see <a class="reference external" href="https://arxiv.org/abs/2103.12571">https://arxiv.org/abs/2103.12571</a></p>
<p>This method changes self.MS directly by accessing active steps through local_MS_active.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>local_MS_active</strong> (<em>list</em>) – all active steps</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether all steps are done</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boot</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.apply_matrix">
<span class="sig-name descname"><span class="pre">apply_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.apply_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.apply_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Apply a matrix on the step level. Needs to be square. Puts the result back into the controller.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mat</strong> – square LxL matrix with L number of steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.compute_all_at_once_residual">
<span class="sig-name descname"><span class="pre">compute_all_at_once_residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_MS_running</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.compute_all_at_once_residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.compute_all_at_once_residual" title="Link to this definition">¶</a></dt>
<dd><p>This requires to communicate the solutions at the end of the steps to be the initial conditions for the next
steps. Afterwards, the residual can be computed locally on the steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>local_MS_running</strong> (<em>list</em>) – list of currently running steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.it_ParaDiag">
<span class="sig-name descname"><span class="pre">it_ParaDiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_MS_running</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.it_ParaDiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.it_ParaDiag" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Do a single ParaDiag iteration. Does the following steps</dt><dd><ul class="simple">
<li><ol class="arabic simple">
<li><p>Compute the residual of the all-at-once / composite collocation problem</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>Compute an FFT in time to diagonalize the preconditioner</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p>Solve the collocation problems locally on the steps for the increment</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="4">
<li><p>Compute iFFT in time to go back to the original base</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="5">
<li><p>Update the solution by adding increment</p></li>
</ol>
</li>
</ul>
</dd>
</dl>
<p>Note that this is the only place where we compute the all-at-once residual because it requires communication and
swaps the solution values for the residuals. So after the residual tolerance is reached, one more ParaDiag
iteration will be done.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>local_MS_running</strong> (<em>list</em>) – list of currently running steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.it_check">
<span class="sig-name descname"><span class="pre">it_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_MS_running</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.it_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.it_check" title="Link to this definition">¶</a></dt>
<dd><p>Key routine to check for convergence/termination</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>local_MS_running</strong> (<em>list</em>) – list of currently running steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.prepare_Jacobians">
<span class="sig-name descname"><span class="pre">prepare_Jacobians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_MS_running</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.prepare_Jacobians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.prepare_Jacobians" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.restart_block">
<span class="sig-name descname"><span class="pre">restart_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">active_slots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.restart_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.restart_block" title="Link to this definition">¶</a></dt>
<dd><p>Helper routine to reset/restart block of (active) steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>active_slots</strong> – list of active steps</p></li>
<li><p><strong>time</strong> – list of new times</p></li>
<li><p><strong>u0</strong> – initial value to distribute across the steps</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tend</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.run" title="Link to this definition">¶</a></dt>
<dd><p>Main driver for running the serial version of ParaDiag</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u0</strong> – initial values</p></li>
<li><p><strong>t0</strong> – starting time</p></li>
<li><p><strong>Tend</strong> – ending time</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>end values on the last step
stats object containing statistics for each step, each level and each iteration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.spread">
<span class="sig-name descname"><span class="pre">spread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_MS_running</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.spread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.spread" title="Link to this definition">¶</a></dt>
<dd><p>Spreading phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>local_MS_running</strong> (<em>list</em>) – list of currently running steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.update_solution">
<span class="sig-name descname"><span class="pre">update_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_MS_running</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/controller_classes/controller_ParaDiag_nonMPI.html#controller_ParaDiag_nonMPI.update_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.update_solution" title="Link to this definition">¶</a></dt>
<dd><p>Since we solve for the increment, we need to update the solution between iterations by adding the increment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>local_MS_running</strong> (<em>list</em>) – list of currently running steps</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">implementations.controller_classes.controller_ParaDiag_nonMPI module</a><ul>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI"><code class="docutils literal notranslate"><span class="pre">controller_ParaDiag_nonMPI</span></code></a><ul>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.ParaDiag"><code class="docutils literal notranslate"><span class="pre">ParaDiag()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.apply_matrix"><code class="docutils literal notranslate"><span class="pre">apply_matrix()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.compute_all_at_once_residual"><code class="docutils literal notranslate"><span class="pre">compute_all_at_once_residual()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.it_ParaDiag"><code class="docutils literal notranslate"><span class="pre">it_ParaDiag()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.it_check"><code class="docutils literal notranslate"><span class="pre">it_check()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.prepare_Jacobians"><code class="docutils literal notranslate"><span class="pre">prepare_Jacobians()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.restart_block"><code class="docutils literal notranslate"><span class="pre">restart_block()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.spread"><code class="docutils literal notranslate"><span class="pre">spread()</span></code></a></li>
<li><a class="reference internal" href="#implementations.controller_classes.controller_ParaDiag_nonMPI.controller_ParaDiag_nonMPI.update_solution"><code class="docutils literal notranslate"><span class="pre">update_solution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="implementations.controller_classes.controller_MPI.html"
                          title="previous chapter">implementations.controller_classes.controller_MPI module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="implementations.controller_classes.controller_nonMPI.html"
                          title="next chapter">implementations.controller_classes.controller_nonMPI module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pySDC/implementations.controller_classes.controller_ParaDiag_nonMPI.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.controller_classes.controller_nonMPI.html" title="implementations.controller_classes.controller_nonMPI module"
             >next</a> |</li>
        <li class="right" >
          <a href="implementations.controller_classes.controller_MPI.html" title="implementations.controller_classes.controller_MPI module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.controller_classes.html" >implementations.controller_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.controller_classes.controller_ParaDiag_nonMPI module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Robert Speck.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>