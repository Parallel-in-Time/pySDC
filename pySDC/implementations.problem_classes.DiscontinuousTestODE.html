<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>implementations.problem_classes.DiscontinuousTestODE module &#8212; pySDC 5.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="implementations.problem_classes.FastWaveSlowWave_0D module" href="implementations.problem_classes.FastWaveSlowWave_0D.html" />
    <link rel="prev" title="implementations.problem_classes.BuckConverter module" href="implementations.problem_classes.BuckConverter.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.FastWaveSlowWave_0D.html" title="implementations.problem_classes.FastWaveSlowWave_0D module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.BuckConverter.html" title="implementations.problem_classes.BuckConverter module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" accesskey="U">implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.DiscontinuousTestODE module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-implementations.problem_classes.DiscontinuousTestODE">
<span id="implementations-problem-classes-discontinuoustestode-module"></span><h1>implementations.problem_classes.DiscontinuousTestODE module<a class="headerlink" href="#module-implementations.problem_classes.DiscontinuousTestODE" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiscontinuousTestODE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newton_maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newton_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/DiscontinuousTestODE.html#DiscontinuousTestODE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptype</span></code></p>
<p>This class implements a very simple test case of a ordinary differential equation consisting of one discrete event. The dynamics of
the solution changes when the state function <span class="math notranslate nohighlight">\(h(u) := u - 5\)</span> changes the sign. The problem is defined by:</p>
<p>if <span class="math notranslate nohighlight">\(u - 5 &lt; 0:\)</span></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\fra{d u}{dt} = u\]</div>
</div></blockquote>
<p>else:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\frac{d u}{dt} = \frac{4}{t^*},\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(t^* = \log(5) \approx 1.6094379\)</span>. For <span class="math notranslate nohighlight">\(h(u) &lt; 0\)</span>, i.e., <span class="math notranslate nohighlight">\(t \leq t^*\)</span> the exact solution is
<span class="math notranslate nohighlight">\(u(t) = exp(t)\)</span>; for <span class="math notranslate nohighlight">\(h(u) \geq 0\)</span>, i.e., <span class="math notranslate nohighlight">\(t \geq t^*\)</span> the exact solution is <span class="math notranslate nohighlight">\(u(t) = \frac{4 t}{t^*} + 1\)</span>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.t_switch_exact">
<span class="sig-name descname"><span class="pre">t_switch_exact</span></span><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.t_switch_exact" title="Permalink to this definition">¶</a></dt>
<dd><p>Exact event time with <span class="math notranslate nohighlight">\(t^* = \log(5)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.t_switch">
<span class="sig-name descname"><span class="pre">t_switch</span></span><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.t_switch" title="Permalink to this definition">¶</a></dt>
<dd><p>Time point of the discrete event found by switch estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.nswitches">
<span class="sig-name descname"><span class="pre">nswitches</span></span><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.nswitches" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of switches found by switch estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.newton_itercount">
<span class="sig-name descname"><span class="pre">newton_itercount</span></span><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.newton_itercount" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of Newton iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.newton_ncalls">
<span class="sig-name descname"><span class="pre">newton_ncalls</span></span><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.newton_ncalls" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of how often Newton is called in the simulation of the problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.count_switches">
<span class="sig-name descname"><span class="pre">count_switches</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/DiscontinuousTestODE.html#DiscontinuousTestODE.count_switches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.count_switches" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter to update the number of switches if one is found.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.dtype_f">
<span class="sig-name descname"><span class="pre">dtype_f</span></span><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.dtype_f" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">mesh</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.dtype_u">
<span class="sig-name descname"><span class="pre">dtype_u</span></span><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.dtype_u" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">mesh</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.eval_f">
<span class="sig-name descname"><span class="pre">eval_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/DiscontinuousTestODE.html#DiscontinuousTestODE.eval_f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.eval_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to evaluate the right-hand side of the problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>dtype_u</em>) – Current values of the numerical solution.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time of the numerical solution is computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f</strong> – The right-hand side of the problem.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_f</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.get_switching_info">
<span class="sig-name descname"><span class="pre">get_switching_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/DiscontinuousTestODE.html#DiscontinuousTestODE.get_switching_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.get_switching_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides information about the state function of the problem. When the state function changes its sign,
typically an event occurs. So the check for an event should be done in the way that the state function
is checked for a sign change. If this is the case, the intermediate value theorem states a root in this
step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>dtype_u</em>) – Current values of the numerical solution at time t.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time of the numerical solution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>switch_detected</strong> (<em>bool</em>) – Indicates whether a discrete event is found or not.</p></li>
<li><p><strong>m_guess</strong> (<em>int</em>) – The index before the sign changes.</p></li>
<li><p><strong>state_function</strong> (<em>list</em>) – Defines the values of the state function at collocation nodes where it changes the sign.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.solve_system">
<span class="sig-name descname"><span class="pre">solve_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/DiscontinuousTestODE.html#DiscontinuousTestODE.solve_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.solve_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple Newton solver for <span class="math notranslate nohighlight">\((I-factor\cdot A)\vec{u}=\vec{rhs}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhs</strong> (<em>dtype_f</em>) – Right-hand side for the linear system.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Abbrev. for the local stepsize (or any other factor required).</p></li>
<li><p><strong>u0</strong> (<em>dtype_u</em>) – Initial guess for the iterative solver.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time (e.g. for time-dependent BCs).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>me</strong> – The solution as mesh.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_u</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.u_exact">
<span class="sig-name descname"><span class="pre">u_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/DiscontinuousTestODE.html#DiscontinuousTestODE.u_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.u_exact" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to compute the exact solution at time t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Time of the exact solution.</p></li>
<li><p><strong>u_init</strong> (<em>pySDC.problem.DiscontinuousTestODE.dtype_u</em>) – Initial conditions for getting the exact solution.</p></li>
<li><p><strong>t_init</strong> (<em>float</em>) – The starting time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>me</strong> – The exact solution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_u</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">implementations.problem_classes.DiscontinuousTestODE module</a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE"><code class="docutils literal notranslate"><span class="pre">DiscontinuousTestODE</span></code></a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.t_switch_exact"><code class="docutils literal notranslate"><span class="pre">t_switch_exact</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.t_switch"><code class="docutils literal notranslate"><span class="pre">t_switch</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.nswitches"><code class="docutils literal notranslate"><span class="pre">nswitches</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.newton_itercount"><code class="docutils literal notranslate"><span class="pre">newton_itercount</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.newton_ncalls"><code class="docutils literal notranslate"><span class="pre">newton_ncalls</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.count_switches"><code class="docutils literal notranslate"><span class="pre">count_switches()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.dtype_f"><code class="docutils literal notranslate"><span class="pre">dtype_f</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.dtype_u"><code class="docutils literal notranslate"><span class="pre">dtype_u</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.eval_f"><code class="docutils literal notranslate"><span class="pre">eval_f()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.get_switching_info"><code class="docutils literal notranslate"><span class="pre">get_switching_info()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.solve_system"><code class="docutils literal notranslate"><span class="pre">solve_system()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.DiscontinuousTestODE.DiscontinuousTestODE.u_exact"><code class="docutils literal notranslate"><span class="pre">u_exact()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="implementations.problem_classes.BuckConverter.html"
                          title="previous chapter">implementations.problem_classes.BuckConverter module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="implementations.problem_classes.FastWaveSlowWave_0D.html"
                          title="next chapter">implementations.problem_classes.FastWaveSlowWave_0D module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pySDC/implementations.problem_classes.DiscontinuousTestODE.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.FastWaveSlowWave_0D.html" title="implementations.problem_classes.FastWaveSlowWave_0D module"
             >next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.BuckConverter.html" title="implementations.problem_classes.BuckConverter module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" >implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.DiscontinuousTestODE module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Robert Speck.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
  </body>
</html>