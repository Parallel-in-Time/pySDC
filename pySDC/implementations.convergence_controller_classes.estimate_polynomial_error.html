<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>implementations.convergence_controller_classes.estimate_polynomial_error module &#8212; pySDC 5.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=2bf1fcf8" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c40552b6" />
    
    <script src="../_static/documentation_options.js?v=81710850"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="implementations.convergence_controller_classes.hotrod module" href="implementations.convergence_controller_classes.hotrod.html" />
    <link rel="prev" title="implementations.convergence_controller_classes.estimate_extrapolation_error module" href="implementations.convergence_controller_classes.estimate_extrapolation_error.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.convergence_controller_classes.hotrod.html" title="implementations.convergence_controller_classes.hotrod module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="implementations.convergence_controller_classes.estimate_extrapolation_error.html" title="implementations.convergence_controller_classes.estimate_extrapolation_error module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.convergence_controller_classes.html" accesskey="U">implementations.convergence_controller_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.convergence_controller_classes.estimate_polynomial_error module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-implementations.convergence_controller_classes.estimate_polynomial_error">
<span id="implementations-convergence-controller-classes-estimate-polynomial-error-module"></span><h1>implementations.convergence_controller_classes.estimate_polynomial_error module<a class="headerlink" href="#module-implementations.convergence_controller_classes.estimate_polynomial_error" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EstimatePolynomialError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">controller</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ConvergenceController</span></code></p>
<p>Estimate the local error by using all but one collocation node in a polynomial interpolation to that node.
While the converged collocation problem with M nodes gives a order M approximation to this point, the interpolation
gives only an order M-1 approximation. Hence, we have two solutions with different order, and we know their order.
That is to say this gives an error estimate that is order M. Keep in mind that the collocation problem should be
converged for this and has order up to 2M. Still, the lower order method can be used for time step selection, for
instance.
If the last node is not the end point, we can interpolate to that node, which is an order M approximation and compare
to the order 2M approximation we get from the extrapolation step.
By default, we interpolate to the second to last node.</p>
<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.check_parameters">
<span class="sig-name descname"><span class="pre">check_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">controller</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialError.check_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.check_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Check if we allow the scheme to solve the collocation problems to convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>controller</strong> (<em>pySDC.Controller</em>) – The controller</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – The params passed for this specific convergence controller</p></li>
<li><p><strong>description</strong> (<em>dict</em>) – The description object used to instantiate the controller</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the parameters are compatible
str: The error message</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.get_interpolated_solution">
<span class="sig-name descname"><span class="pre">get_interpolated_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialError.get_interpolated_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.get_interpolated_solution" title="Link to this definition">¶</a></dt>
<dd><p>Get the interpolated solution for numpy or cupy data types</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_vec</strong> (<em>array</em>) – Vector of solutions</p></li>
<li><p><strong>prob</strong> (<em>pySDC.problem</em>) – Problem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.matmul">
<span class="sig-name descname"><span class="pre">matmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/home/runner/micromamba/envs/pySDC/lib/python3.13/site-packages/numpy/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialError.matmul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.matmul" title="Link to this definition">¶</a></dt>
<dd><p>Matrix vector multiplication, possibly MPI parallel.
The parallel implementation performs a reduce operation in every row of the matrix. While communicating the
entire vector once could reduce the number of communications, this way we never need to store the entire vector
on any specific rank.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>2d np.ndarray</em>) – Matrix</p></li>
<li><p><strong>b</strong> (<em>list</em>) – Vector</p></li>
<li><p><strong>xp</strong> – Either numpy or cupy</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axb</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.post_iteration_processing">
<span class="sig-name descname"><span class="pre">post_iteration_processing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">controller</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialError.post_iteration_processing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.post_iteration_processing" title="Link to this definition">¶</a></dt>
<dd><p>Estimate the error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>controller</strong> (<em>pySDC.Controller.controller</em>) – The controller</p></li>
<li><p><strong>S</strong> (<em>pySDC.Step.step</em>) – The current step</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.reset_status_variables">
<span class="sig-name descname"><span class="pre">reset_status_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialError.reset_status_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.reset_status_variables" title="Link to this definition">¶</a></dt>
<dd><p>Add variable for embedded error</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">controller</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialError.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.setup" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>controller</strong> (<em>pySDC.Controller.controller</em>) – The controller</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – The params passed for this specific convergence controller</p></li>
<li><p><strong>description</strong> (<em>dict</em>) – The description object used to instantiate the controller</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated params dictionary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EstimatePolynomialErrorFiredrake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">controller</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialErrorFiredrake"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError" title="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimatePolynomialError</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake.get_interpolated_solution">
<span class="sig-name descname"><span class="pre">get_interpolated_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialErrorFiredrake.get_interpolated_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake.get_interpolated_solution" title="Link to this definition">¶</a></dt>
<dd><p>Get the interpolated solution for Firedrake data types
We are not 100% sure that you don’t need to invert the mass matrix here, but should be fine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_vec</strong> (<em>array</em>) – Vector of solutions</p></li>
<li><p><strong>prob</strong> (<em>pySDC.problem</em>) – Problem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake.matmul">
<span class="sig-name descname"><span class="pre">matmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/convergence_controller_classes/estimate_polynomial_error.html#EstimatePolynomialErrorFiredrake.matmul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake.matmul" title="Link to this definition">¶</a></dt>
<dd><p>Matrix vector multiplication, possibly MPI parallel.
The parallel implementation performs a reduce operation in every row of the matrix. While communicating the
entire vector once could reduce the number of communications, this way we never need to store the entire vector
on any specific rank.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>2d np.ndarray</em>) – Matrix</p></li>
<li><p><strong>b</strong> (<em>list</em>) – Vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axb</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">implementations.convergence_controller_classes.estimate_polynomial_error module</a><ul>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError"><code class="docutils literal notranslate"><span class="pre">EstimatePolynomialError</span></code></a><ul>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.check_parameters"><code class="docutils literal notranslate"><span class="pre">check_parameters()</span></code></a></li>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.get_interpolated_solution"><code class="docutils literal notranslate"><span class="pre">get_interpolated_solution()</span></code></a></li>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.matmul"><code class="docutils literal notranslate"><span class="pre">matmul()</span></code></a></li>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.post_iteration_processing"><code class="docutils literal notranslate"><span class="pre">post_iteration_processing()</span></code></a></li>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.reset_status_variables"><code class="docutils literal notranslate"><span class="pre">reset_status_variables()</span></code></a></li>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialError.setup"><code class="docutils literal notranslate"><span class="pre">setup()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake"><code class="docutils literal notranslate"><span class="pre">EstimatePolynomialErrorFiredrake</span></code></a><ul>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake.get_interpolated_solution"><code class="docutils literal notranslate"><span class="pre">get_interpolated_solution()</span></code></a></li>
<li><a class="reference internal" href="#implementations.convergence_controller_classes.estimate_polynomial_error.EstimatePolynomialErrorFiredrake.matmul"><code class="docutils literal notranslate"><span class="pre">matmul()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="implementations.convergence_controller_classes.estimate_extrapolation_error.html"
                          title="previous chapter">implementations.convergence_controller_classes.estimate_extrapolation_error module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="implementations.convergence_controller_classes.hotrod.html"
                          title="next chapter">implementations.convergence_controller_classes.hotrod module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pySDC/implementations.convergence_controller_classes.estimate_polynomial_error.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.convergence_controller_classes.hotrod.html" title="implementations.convergence_controller_classes.hotrod module"
             >next</a> |</li>
        <li class="right" >
          <a href="implementations.convergence_controller_classes.estimate_extrapolation_error.html" title="implementations.convergence_controller_classes.estimate_extrapolation_error module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.convergence_controller_classes.html" >implementations.convergence_controller_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.convergence_controller_classes.estimate_polynomial_error module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Robert Speck.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.3.0.
    </div>
  </body>
</html>