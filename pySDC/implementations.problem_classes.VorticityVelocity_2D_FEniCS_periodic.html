<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic module &#8212; pySDC 5.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=514cf933" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c40552b6" />
    
    <script src="../_static/documentation_options.js?v=5c0b1849"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="implementations.problem_classes.generic_ND_FD module" href="implementations.problem_classes.generic_ND_FD.html" />
    <link rel="prev" title="implementations.problem_classes.Van_der_Pol_implicit module" href="implementations.problem_classes.Van_der_Pol_implicit.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.generic_ND_FD.html" title="implementations.problem_classes.generic_ND_FD module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.Van_der_Pol_implicit.html" title="implementations.problem_classes.Van_der_Pol_implicit module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" accesskey="U">implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic">
<span id="implementations-problem-classes-vorticityvelocity-2d-fenics-periodic-module"></span><h1>implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic module<a class="headerlink" href="#module-implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fenics_vortex_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_nvars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/VorticityVelocity_2D_FEniCS_periodic.html#fenics_vortex_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptype</span></code></p>
<p>This class implements the vorticity-velocity problem in two dimensions with periodic boundary conditions
in <span class="math notranslate nohighlight">\([0, 1]^2\)</span></p>
<div class="math notranslate nohighlight">
\[\frac{\partial w}{\partial t} = \nu \Delta w\]</div>
<p>for some parameter <span class="math notranslate nohighlight">\(\nu\)</span>. In this class the problem is implemented that the spatial port is solved
using FEniCS <a class="footnote-reference brackets" href="#id3" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Hence, the problem is reformulated to the <em>weak formulation</em></p>
<div class="math notranslate nohighlight">
\[\int_\Omega w_t v dx = - \nu \int_\Omega \nabla w \nabla v dx\]</div>
<p>The nonlinear system is solved in a <em>fully-implicit</em> way using Dolfin’s weak solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_nvars</strong> (<em>List</em><em> of </em><em>int tuple</em><em>, </em><em>optional</em>) – Spatial resolution, i.e., numbers of degrees of freedom in space, e.g. [(128, 128)].</p></li>
<li><p><strong>family</strong> (<em>str</em><em>, </em><em>optional</em>) – Indicates the family of elements used to create the function space
for the trail and test functions. The default is ‘CG’, which are the class
of Continuous Galerkin, a <em>synonym</em> for the Lagrange family of elements, see <a class="footnote-reference brackets" href="#id4" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – Defines the order of the elements in the function space.</p></li>
<li><p><strong>refinements</strong> (<em>int</em><em>, </em><em>optional</em>) – Denotes the refinement of the mesh. refinements=2 refines the mesh by factor <span class="math notranslate nohighlight">\(2\)</span>.</p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>optional</em>) – Diffusion coefficient <span class="math notranslate nohighlight">\(\nu\)</span>.</p></li>
<li><p><strong>rho</strong> (<em>int</em><em>, </em><em>optional</em>) – Problem parameter.</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – Problem parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.V">
<span class="sig-name descname"><span class="pre">V</span></span><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.V" title="Link to this definition">¶</a></dt>
<dd><p>Defines the function space of the trial and test functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FunctionSpace</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.M">
<span class="sig-name descname"><span class="pre">M</span></span><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.M" title="Link to this definition">¶</a></dt>
<dd><p>Mass matrix for FENiCS.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar, vector, matrix or higher rank tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.K">
<span class="sig-name descname"><span class="pre">K</span></span><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.K" title="Link to this definition">¶</a></dt>
<dd><p>Stiffness matrix including diffusion coefficient (and correct sign).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar, vector, matrix or higher rank tensor</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>The FEniCS Project Version 1.5. M. S. Alnaes, J. Blechta, J. Hake, A. Johansson, B. Kehlet, A. Logg,
C. Richardson, J. Ring, M. E. Rognes, G. N. Wells. Archive of Numerical Software (2015).</p>
</aside>
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Automated Solution of Differential Equations by the Finite Element Method. A. Logg, K.-A. Mardal, G. N.
Wells and others. Springer (2012).</p>
</aside>
</aside>
<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.dtype_f">
<span class="sig-name descname"><span class="pre">dtype_f</span></span><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.dtype_f" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">rhs_fenics_mesh</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.dtype_u">
<span class="sig-name descname"><span class="pre">dtype_u</span></span><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.dtype_u" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">fenics_mesh</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.eval_f">
<span class="sig-name descname"><span class="pre">eval_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/VorticityVelocity_2D_FEniCS_periodic.html#fenics_vortex_2d.eval_f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.eval_f" title="Link to this definition">¶</a></dt>
<dd><p>Routine to evaluate both parts of the right-hand side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>dtype_u</em>) – Current values of the numerical solution.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time at which the numerical solution is computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f</strong> – The right-hand side divided into two parts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_f</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.solve_system">
<span class="sig-name descname"><span class="pre">solve_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/VorticityVelocity_2D_FEniCS_periodic.html#fenics_vortex_2d.solve_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.solve_system" title="Link to this definition">¶</a></dt>
<dd><p>Dolfin’s linear solver for <span class="math notranslate nohighlight">\((M - factor A)\vec{u} = \vec{rhs}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhs</strong> (<em>dtype_f</em>) – Right-hand side for the nonlinear system.</p></li>
<li><p><strong>factor</strong> (<em>float</em>) – Abbrev. for the node-to-node stepsize (or any other factor required).</p></li>
<li><p><strong>u0</strong> (<em>dtype_u</em>) – Initial guess for the iterative solver (not used here so far).</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>u</strong> – The solution as mesh.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_u</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.u_exact">
<span class="sig-name descname"><span class="pre">u_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/VorticityVelocity_2D_FEniCS_periodic.html#fenics_vortex_2d.u_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.u_exact" title="Link to this definition">¶</a></dt>
<dd><p>Routine to compute the exact solution at time t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<em>float</em>) – Time of the exact solution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>me</strong> – The exact solution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_u</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic module</a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d"><code class="docutils literal notranslate"><span class="pre">fenics_vortex_2d</span></code></a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.V"><code class="docutils literal notranslate"><span class="pre">V</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.M"><code class="docutils literal notranslate"><span class="pre">M</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.K"><code class="docutils literal notranslate"><span class="pre">K</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.dtype_f"><code class="docutils literal notranslate"><span class="pre">dtype_f</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.dtype_u"><code class="docutils literal notranslate"><span class="pre">dtype_u</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.eval_f"><code class="docutils literal notranslate"><span class="pre">eval_f()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.solve_system"><code class="docutils literal notranslate"><span class="pre">solve_system()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.fenics_vortex_2d.u_exact"><code class="docutils literal notranslate"><span class="pre">u_exact()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="implementations.problem_classes.Van_der_Pol_implicit.html"
                          title="previous chapter">implementations.problem_classes.Van_der_Pol_implicit module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="implementations.problem_classes.generic_ND_FD.html"
                          title="next chapter">implementations.problem_classes.generic_ND_FD module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pySDC/implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.generic_ND_FD.html" title="implementations.problem_classes.generic_ND_FD module"
             >next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.Van_der_Pol_implicit.html" title="implementations.problem_classes.Van_der_Pol_implicit module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" >implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.VorticityVelocity_2D_FEniCS_periodic module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, Robert Speck.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>