<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>implementations.problem_classes.Lorenz module &#8212; pySDC 5.5.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=def86cc0" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c40552b6" />
    
    <script src="../_static/documentation_options.js?v=3005adad"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="implementations.problem_classes.NonlinearSchroedinger_MPIFFT module" href="implementations.problem_classes.NonlinearSchroedinger_MPIFFT.html" />
    <link rel="prev" title="implementations.problem_classes.LogisticEquation module" href="implementations.problem_classes.LogisticEquation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.NonlinearSchroedinger_MPIFFT.html" title="implementations.problem_classes.NonlinearSchroedinger_MPIFFT module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.LogisticEquation.html" title="implementations.problem_classes.LogisticEquation module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" accesskey="U">implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.Lorenz module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-implementations.problem_classes.Lorenz">
<span id="implementations-problem-classes-lorenz-module"></span><h1>implementations.problem_classes.Lorenz module<a class="headerlink" href="#module-implementations.problem_classes.Lorenz" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="implementations.problem_classes.Lorenz.LorenzAttractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LorenzAttractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.6666666666666665</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newton_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newton_maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_at_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/Lorenz.html#LorenzAttractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.Lorenz.LorenzAttractor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Problem</span></code></p>
<p>Simple script to run a Lorenz attractor problem.</p>
<p>The Lorenz attractor is a system of three ordinary differential equations (ODEs) that exhibits some chaotic behaviour.
It is well known for the “Butterfly Effect”, because the solution looks like a butterfly (solve to <span class="math notranslate nohighlight">\(T_{end} = 100\)</span>
or so to see this with these initial conditions) and because of the chaotic nature.</p>
<p>Lorenz developed this system from equations modelling convection in a layer of fluid with the top and bottom surfaces
kept at different temperatures. In the notation used here, the first component of u is proportional to the convective
motion, the second component is proportional to the temperature difference between the surfaces and the third component
is proportional to the distortion of the vertical temperature profile from linearity.</p>
<p>See doi.org/10.1175/1520-0469(1963)020&lt;0130:DNF&gt;2.0.CO;2 for the original publication.</p>
<p>Since the problem is non-linear, we need to use a Newton solver.</p>
<p>The system of ODEs is given by</p>
<div class="math notranslate nohighlight">
\[\frac{d y_1(t)}{dt} = \sigma (y_2 (t) - y_1 (t)),\]</div>
<div class="math notranslate nohighlight">
\[\frac{d y_2(t)}{dt} = \rho y_1 (t) - y_2 (t) - y_1 (t) y_3 (t),\]</div>
<div class="math notranslate nohighlight">
\[\frac{d y_3(t)}{dt} = y_1 (t) y_2 (t) - \beta y_3 (t)\]</div>
<p>with initial condition <span class="math notranslate nohighlight">\((y_1(0), y_2(0), y_3(0))^T = (1, 1, 1)^T\)</span> (default) for <span class="math notranslate nohighlight">\(t \in [0, 1]\)</span>.
The problem parameters for this problem are <span class="math notranslate nohighlight">\(\sigma = 10\)</span>, <span class="math notranslate nohighlight">\(\rho = 28\)</span> and <span class="math notranslate nohighlight">\(\beta = 8/3\)</span>.
Lorenz chose these parameters such that the Reynolds number <span class="math notranslate nohighlight">\(\rho\)</span> is slightly supercritical
as to provoke instability of steady convection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Parameter <span class="math notranslate nohighlight">\(\sigma\)</span> of the problem.</p></li>
<li><p><strong>rho</strong> (<em>float</em><em>, </em><em>optional</em>) – Parameter <span class="math notranslate nohighlight">\(\rho\)</span> of the problem.</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Parameter <span class="math notranslate nohighlight">\(\beta\)</span> of the problem.</p></li>
<li><p><strong>u0</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Initial solution <span class="math notranslate nohighlight">\(u_0\)</span> of the problem.</p></li>
<li><p><strong>newton_tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Tolerance for Newton for termination.</p></li>
<li><p><strong>newton_maxiter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations for Newton’s method.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.Lorenz.LorenzAttractor.work_counter">
<span class="sig-name descname"><span class="pre">work_counter</span></span><a class="headerlink" href="#implementations.problem_classes.Lorenz.LorenzAttractor.work_counter" title="Link to this definition">¶</a></dt>
<dd><p>Counts the iterations/nfev (here for Newton’s method and the nfev for the right-hand side).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.Lorenz.LorenzAttractor.dtype_f">
<span class="sig-name descname"><span class="pre">dtype_f</span></span><a class="headerlink" href="#implementations.problem_classes.Lorenz.LorenzAttractor.dtype_f" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">mesh</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.Lorenz.LorenzAttractor.dtype_u">
<span class="sig-name descname"><span class="pre">dtype_u</span></span><a class="headerlink" href="#implementations.problem_classes.Lorenz.LorenzAttractor.dtype_u" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">mesh</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.Lorenz.LorenzAttractor.eval_f">
<span class="sig-name descname"><span class="pre">eval_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/Lorenz.html#LorenzAttractor.eval_f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.Lorenz.LorenzAttractor.eval_f" title="Link to this definition">¶</a></dt>
<dd><p>Routine to evaluate the right-hand side of the problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>dtype_u</em>) – Current values of the numerical solution.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time of the numerical solution is computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f</strong> – The right-hand side of the problem.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_f</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.Lorenz.LorenzAttractor.solve_system">
<span class="sig-name descname"><span class="pre">solve_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/Lorenz.html#LorenzAttractor.solve_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.Lorenz.LorenzAttractor.solve_system" title="Link to this definition">¶</a></dt>
<dd><p>Simple Newton solver for the nonlinear system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhs</strong> (<em>dtype_f</em>) – Right-hand side for the nonlinear system.</p></li>
<li><p><strong>factor</strong> (<em>float</em>) – Abbrev. for the local stepsize (or any other factor required).</p></li>
<li><p><strong>u0</strong> (<em>dtype_u</em>) – Initial guess for the iterative solver</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time (e.g. for time-dependent BCs).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>me</strong> – The solution as mesh.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_u</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.Lorenz.LorenzAttractor.u_exact">
<span class="sig-name descname"><span class="pre">u_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/Lorenz.html#LorenzAttractor.u_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.Lorenz.LorenzAttractor.u_exact" title="Link to this definition">¶</a></dt>
<dd><p>Routine to return initial conditions or to approximate exact solution using <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Time at which the approximated exact solution is computed.</p></li>
<li><p><strong>u_init</strong> (<em>pySDC.implementations.problem_classes.Lorenz.dtype_u</em>) – Initial conditions for getting the exact solution.</p></li>
<li><p><strong>t_init</strong> (<em>float</em>) – The starting time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>me</strong> – The approximated exact solution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_u</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">implementations.problem_classes.Lorenz module</a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.Lorenz.LorenzAttractor"><code class="docutils literal notranslate"><span class="pre">LorenzAttractor</span></code></a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.Lorenz.LorenzAttractor.work_counter"><code class="docutils literal notranslate"><span class="pre">work_counter</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.Lorenz.LorenzAttractor.dtype_f"><code class="docutils literal notranslate"><span class="pre">dtype_f</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.Lorenz.LorenzAttractor.dtype_u"><code class="docutils literal notranslate"><span class="pre">dtype_u</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.Lorenz.LorenzAttractor.eval_f"><code class="docutils literal notranslate"><span class="pre">eval_f()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.Lorenz.LorenzAttractor.solve_system"><code class="docutils literal notranslate"><span class="pre">solve_system()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.Lorenz.LorenzAttractor.u_exact"><code class="docutils literal notranslate"><span class="pre">u_exact()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="implementations.problem_classes.LogisticEquation.html"
                          title="previous chapter">implementations.problem_classes.LogisticEquation module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="implementations.problem_classes.NonlinearSchroedinger_MPIFFT.html"
                          title="next chapter">implementations.problem_classes.NonlinearSchroedinger_MPIFFT module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pySDC/implementations.problem_classes.Lorenz.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.NonlinearSchroedinger_MPIFFT.html" title="implementations.problem_classes.NonlinearSchroedinger_MPIFFT module"
             >next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.LogisticEquation.html" title="implementations.problem_classes.LogisticEquation module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" >implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.Lorenz module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Robert Speck.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    </div>
  </body>
</html>