<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>implementations.problem_classes.RayleighBenard3D module &#8212; pySDC 5.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=2bf1fcf8" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c40552b6" />
    
    <script src="../_static/documentation_options.js?v=81710850"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="implementations.problem_classes.TestEquation_0D module" href="implementations.problem_classes.TestEquation_0D.html" />
    <link rel="prev" title="implementations.problem_classes.RayleighBenard module" href="implementations.problem_classes.RayleighBenard.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.TestEquation_0D.html" title="implementations.problem_classes.TestEquation_0D module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.RayleighBenard.html" title="implementations.problem_classes.RayleighBenard module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" accesskey="U">implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.RayleighBenard3D module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-implementations.problem_classes.RayleighBenard3D">
<span id="implementations-problem-classes-rayleighbenard3d-module"></span><h1>implementations.problem_classes.RayleighBenard3D module<a class="headerlink" href="#module-implementations.problem_classes.RayleighBenard3D" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="implementations.problem_classes.RayleighBenard3D.RayleighBenard3D">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RayleighBenard3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Prandtl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rayleigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BCs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dealiasing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGPU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/RayleighBenard3D.html#RayleighBenard3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GenericSpectralLinear</span></code></p>
<p>Rayleigh-Benard Convection is a variation of incompressible Navier-Stokes.</p>
<p>The equations we solve are</p>
<blockquote>
<div><p>u_x + v_y + w_z = 0
T_t - kappa (T_xx + T_yy + T_zz) = -uT_x - vT_y - wT_z
u_t - nu (u_xx + u_yy + u_zz) + p_x = -uu_x - vu_y - wu_z
v_t - nu (v_xx + v_yy + v_zz) + p_y = -uv_x - vv_y - wv_z
w_t - nu (w_xx + w_yy + w_zz) + p_z - T = -uw_x - vw_y - ww_z</p>
</div></blockquote>
<p>with u the horizontal velocity, v the vertical velocity (in z-direction), T the temperature, p the pressure, indices
denoting derivatives, kappa=(Rayleigh * Prandtl)**(-1/2) and nu = (Rayleigh / Prandtl)**(-1/2). Everything on the left
hand side, that is the viscous part, the pressure gradient and the buoyancy due to temperature are treated
implicitly, while the non-linear convection part on the right hand side is integrated explicitly.</p>
<p>The domain, vertical boundary conditions and pressure gauge are</p>
<blockquote>
<div><p>Omega = [0, 8) x (-1, 1)
T(z=+1) = 0
T(z=-1) = 2
u(z=+-1) = v(z=+-1) = 0
integral over p = 0</p>
</div></blockquote>
<p>The spectral discretization uses FFT horizontally, implying periodic BCs, and an ultraspherical method vertically to
facilitate the Dirichlet BCs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Prandtl</strong> (<em>float</em>) – Prandtl number</p></li>
<li><p><strong>Rayleigh</strong> (<em>float</em>) – Rayleigh number</p></li>
<li><p><strong>nx</strong> (<em>int</em>) – Horizontal resolution</p></li>
<li><p><strong>nz</strong> (<em>int</em>) – Vertical resolution</p></li>
<li><p><strong>BCs</strong> (<em>dict</em>) – Can specify boundary conditions here</p></li>
<li><p><strong>dealiasing</strong> (<em>float</em>) – Dealiasing factor for evaluating the non-linear part</p></li>
<li><p><strong>comm</strong> (<em>mpi4py.Intracomm</em>) – Space communicator</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.compute_Nusselt_numbers">
<span class="sig-name descname"><span class="pre">compute_Nusselt_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/RayleighBenard3D.html#RayleighBenard3D.compute_Nusselt_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.compute_Nusselt_numbers" title="Link to this definition">¶</a></dt>
<dd><p>Compute the various versions of the Nusselt number. This reflects the type of heat transport.
If the Nusselt number is equal to one, it indicates heat transport due to conduction. If it is larger,
advection is present.
Computing the Nusselt number at various places can be used to check the code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> – The solution you want to compute the Nusselt numbers of</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nusselt number averaged over the entire volume and horizontally averaged at the top and bottom.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.dtype_f">
<span class="sig-name descname"><span class="pre">dtype_f</span></span><a class="headerlink" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.dtype_f" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">imex_mesh</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.dtype_u">
<span class="sig-name descname"><span class="pre">dtype_u</span></span><a class="headerlink" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.dtype_u" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">mesh</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.eval_f">
<span class="sig-name descname"><span class="pre">eval_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/RayleighBenard3D.html#RayleighBenard3D.eval_f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.eval_f" title="Link to this definition">¶</a></dt>
<dd><p>Abstract interface to RHS computation of the ODE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>dtype_u</em>) – Current values.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Current time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f</strong> – The RHS values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtype_f</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.u_exact">
<span class="sig-name descname"><span class="pre">u_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/implementations/problem_classes/RayleighBenard3D.html#RayleighBenard3D.u_exact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.u_exact" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">implementations.problem_classes.RayleighBenard3D module</a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D"><code class="docutils literal notranslate"><span class="pre">RayleighBenard3D</span></code></a><ul>
<li><a class="reference internal" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.compute_Nusselt_numbers"><code class="docutils literal notranslate"><span class="pre">compute_Nusselt_numbers()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.dtype_f"><code class="docutils literal notranslate"><span class="pre">dtype_f</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.dtype_u"><code class="docutils literal notranslate"><span class="pre">dtype_u</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.eval_f"><code class="docutils literal notranslate"><span class="pre">eval_f()</span></code></a></li>
<li><a class="reference internal" href="#implementations.problem_classes.RayleighBenard3D.RayleighBenard3D.u_exact"><code class="docutils literal notranslate"><span class="pre">u_exact()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="implementations.problem_classes.RayleighBenard.html"
                          title="previous chapter">implementations.problem_classes.RayleighBenard module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="implementations.problem_classes.TestEquation_0D.html"
                          title="next chapter">implementations.problem_classes.TestEquation_0D module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pySDC/implementations.problem_classes.RayleighBenard3D.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.TestEquation_0D.html" title="implementations.problem_classes.TestEquation_0D module"
             >next</a> |</li>
        <li class="right" >
          <a href="implementations.problem_classes.RayleighBenard.html" title="implementations.problem_classes.RayleighBenard module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pySDC 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="implementations.html" >implementations package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="implementations.problem_classes.html" >implementations.problem_classes package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">implementations.problem_classes.RayleighBenard3D module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Robert Speck.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>